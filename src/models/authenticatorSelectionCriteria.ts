/**
 * FusionAuth APILib
 *
 * This file was automatically generated by APIMATIC v3.0 ( https://www.apimatic.io ).
 */

import { boolean, object, optional, Schema } from '../schema';
import {
  AuthenticatorAttachmentEnum,
  authenticatorAttachmentEnumSchema,
} from './authenticatorAttachmentEnum';
import {
  ResidentKeyRequirementEnum,
  residentKeyRequirementEnumSchema,
} from './residentKeyRequirementEnum';
import {
  UserVerificationRequirementEnum,
  userVerificationRequirementEnumSchema,
} from './userVerificationRequirementEnum';

/** Used by the Relying Party to specify their requirements for authenticator attributes. Fields use the deprecated "resident key" terminology to refer  to client-side discoverable credentials to maintain backwards compatibility with WebAuthn Level 1. */
export interface AuthenticatorSelectionCriteria {
  /** Describes the <a href="https:www.w3.orgTRwebauthn-2#authenticator-attachment-modality">authenticator attachment modality<a>. */
  authenticatorAttachment?: AuthenticatorAttachmentEnum;
  requireResidentKey?: boolean;
  /** Describes the Relying Party's requirements for <a href="https:www.w3.orgTRwebauthn-2#client-side-discoverable-credential">client-side  discoverable credentials<a> (formerly known as "resident keys") */
  residentKey?: ResidentKeyRequirementEnum;
  /** Used to express whether the Relying Party requires <a href="https:www.w3.orgTRwebauthn-2#user-verification">user verification<a> for the  current operation. */
  userVerification?: UserVerificationRequirementEnum;
}

export const authenticatorSelectionCriteriaSchema: Schema<AuthenticatorSelectionCriteria> = object(
  {
    authenticatorAttachment: [
      'authenticatorAttachment',
      optional(authenticatorAttachmentEnumSchema),
    ],
    requireResidentKey: ['requireResidentKey', optional(boolean())],
    residentKey: ['residentKey', optional(residentKeyRequirementEnumSchema)],
    userVerification: [
      'userVerification',
      optional(userVerificationRequirementEnumSchema),
    ],
  }
);
